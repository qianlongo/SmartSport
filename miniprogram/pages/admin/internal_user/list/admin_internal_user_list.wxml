<block wx:if="{{isAdmin}}">
	<cmpt-comm-list id="comm-list" type="admin-internal-user" search="{{search}}" _menus="{{sortMenus}}" _items="{{sortItems}}" route="admin/internal_user_list" sortMenusDefaultIndex="0" topBottom="50" placeholder="搜索姓名、手机号、单位" bind:list="bindCommListCmpt" sortMenusDefaultIndex="0">

		<view slot="searchEnd">
			<button bindtap="bindAddTap" class="btn mid radius bg-admin text-white margin-right-s"><text class="icon-roundadd margin-right-xxs"></text>添加人员</button>
			<button bindtap="bindImportExportTap" class="btn mid radius bg-admin text-white margin-right-s"><text class="icon-down margin-right-xxs"></text>批量导入</button>
		</view>

		<!-- List Begin -->
		<view class="admin-comm-list">
			<view wx:if="{{dataList && dataList.total }}" class="load text-grey">共有{{dataList.total}}条符合条件记录 </view>

			<view class="item" wx:for="{{dataList.list}}" wx:key="key">
				<view class="header">
					<view class="left text-cut">{{item.INTERNAL_USER_NAME}}
					</view>
					<view class="right">
						<text wx:if="{{item.INTERNAL_USER_STATUS==0}}" class="text-grey">已禁用</text>
						<text wx:elif="{{item.INTERNAL_USER_STATUS==1}}" class="text-black">正常</text>
					</view>
				</view>

				<view class="info">
					<view class="info-item" bindtap="url" data-type="phone" data-url="{{item.INTERNAL_USER_MOBILE}}">
						<view class="title">手机</view>
						<view class="mao">：</view>
						<view class="content">{{item.INTERNAL_USER_MOBILE||'未填写'}} <text wx:if="{{item.INTERNAL_USER_MOBILE}}" class="icon-phone margin-left-s"></text></view>
					</view> 

					<view class="info-item">
						<view class="title">导入时间</view>
						<view class="mao">：</view>
						<view class="content">{{item.INTERNAL_USER_IMPORT_TIME_FORMAT}}</view>
					</view>

					<view class="info-item">
						<view class="title">录入人员</view>
						<view class="mao">：</view>
						<view class="content">{{item.INTERNAL_USER_IMPORT_ADMIN_NAME||'未知'}}</view>
					</view>

					<view class="oprt">
						<view bindtap="bindEditTap" data-item="{{item}}" class="btn margin-right-s"><text class="icon-edit margin-right-xxs text-blue"></text>编辑</view>
						<view wx:if="{{item.INTERNAL_USER_STATUS==1}}" bindtap="bindStatusTap" data-id="{{item.INTERNAL_USER_ID}}" data-status="0" class="btn margin-right-s"><text class="icon-stop margin-right-xxs text-orange"></text>禁用</view>
						<view wx:elif="{{item.INTERNAL_USER_STATUS==0}}" bindtap="bindStatusTap" data-id="{{item.INTERNAL_USER_ID}}" data-status="1" class="btn margin-right-s"><text class="icon-play margin-right-xxs text-green"></text>启用</view>

						<view bindtap="bindDelTap" data-id="{{item.INTERNAL_USER_ID}}" class="btn"><text class="icon-delete margin-right-xxs text-red"></text>删除</view>
					</view>
				</view>
			</view>
		</view>
		<!-- List END -->

		<!--load begin-->
		<import src="../../../../tpls/public/list_load_tpl.wxml" />
		<template is="listLoadTpl" data="{{skin:'text-grey',dataList}}" />
		<!--load end-->

	</cmpt-comm-list>

	<!-- 添加/编辑弹窗 -->
	<view wx:if="{{showModal}}" class="modal-mask" bindtap="bindModalMaskTap">
		<view class="modal-content" catchtap="bindModalContentTap">
			<view class="modal-header">
				<text class="modal-title">{{isEdit ? '编辑内部人员' : '添加内部人员'}}</text>
				<text class="modal-close" bindtap="bindModalCloseTap">×</text>
			</view>
			<view class="modal-body">
				<view class="form-group">
					<view class="form-label"><text class="required">*</text>姓名：</view>
					<input class="form-input" placeholder="请输入姓名" model:value="{{formName}}" bindinput="bindNameInput" maxlength="20" />
				</view>
				<view class="form-group">
					<view class="form-label"><text class="required">*</text>手机号：</view>
					<input class="form-input" placeholder="请输入手机号" model:value="{{formMobile}}" bindinput="bindMobileInput" maxlength="11" type="number" />
				</view>
			</view>
			<view class="modal-footer">
				<button class="btn btn-cancel" bindtap="bindModalCloseTap">取消</button>
				<button class="btn {{canSubmit ? 'bg-admin text-white' : 'btn-confirm-disabled'}}" bindtap="bindConfirmTap">确定</button>
			</view>
		</view>
	</view>

</block> 